generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id                String         @id @default(uuid())
  email             String         @unique
  firstName         String
  lastName          String
  phoneNumber       String?
  countryCode       String?
  password          String?
  roles             RoleType[]
  agreedToTerms     Boolean
  isVerified        Boolean        @default(false)
  verificationToken String?
  provider          String?
  providerId        String?
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  status            UserStatus     @default(PENDING)
  Products          Products[]
  profile           Profile?
  refreshTokens     RefreshToken[]
}

model Profile {
  id                 String              @id @default(uuid())
  userId             String              @unique
  userAccountType    UserAccountType     @default(INDIVIDUAL)
  incomeFrequency    IncomeFrequencyType @default(MONTHLY)
  totalAnnualRevenue Float               @default(0.0)
  addressLine1       String
  addressLine2       String?
  zipCode            String
  city               String
  state              String
  country            String
  companyName        String
  companyEmail       String
  companyTelephone   String
  companyAddress     String
  bankName           String
  accountNumber      String
  accountName        String
  routingNumber      String
  ibanNumber         String
  swiftNumber        String
  bankAccountType    BankAccountType     @default(PERSONAL)
  bankAddress        String
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
  imageKey           String?
  user               User                @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Admin {
  id            String         @id @default(uuid())
  name          String
  email         String         @unique
  password      String
  role          AdminRoleType
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  refreshTokens RefreshToken[]
}

model Category {
  id           String       @id @default(uuid())
  name         String       @unique
  imageUrl     String?
  categoryType CategoryType
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  block        Boolean      @default(false)
  assets       Asset[]
  product      Products[]
}

model AssetType {
  id        String   @id @default(uuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  assets    Asset[]
}

model TokenType {
  id        String   @id @default(uuid())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  assets    Asset[]
}

model Products {
  id                  String    @id @default(uuid())
  productName         String
  brand               String
  numberOfProducts    String
  hsCode              String
  eanCode             String
  upcCode             String
  categoryId          String?
  totalValue          String
  investmentProfit    Float
  adminCommission     Float?
  unitPrice           String?
  productTotalValue   Float?
  description         String
  riskScale           RiskScale
  offerStartDate      DateTime
  offerEndDate        DateTime
  investmentStartDate DateTime
  maturityCountDays   Int
  maturityDate        DateTime
  createdAt           DateTime  @default(now())
  updatedAt           DateTime  @updatedAt
  campaignerId        String?
  creatorId           String?
  assetImageKey       String?
  auditorsReportKey   String?
  documentKey         String?
  imageOneKey         String?
  imageTwoKey         String?
  tokenImageKey       String?
  status              Status    @default(PENDING)
  campaigner          User?     @relation(fields: [campaignerId], references: [id], onDelete: Cascade)
  category            Category? @relation(fields: [categoryId], references: [id], onDelete: Cascade)
}

model Product { 

  id          String   @id @default(uuid()) 

  name        String 

  description String? 

  sku         String? 

  brand       String? 

  images      String[] 

  categoryId  String? 

  tags        String[] 

 

  // Crowdfunding only 

  interestRate       Float?   // annualized or period-based, FIAT return 

  interestMethod     String?  // SIMPLE_INTEREST or COMPOUND 

  interestPeriodDays Int?     // e.g. 30/90/180/365 

 

  createdAt   DateTime @default(now()) 

  updatedAt   DateTime @updatedAt 

} 
model Asset {
  id                String    @id @default(uuid())
  assetName         String
  tokenName         String
  tokenValue        String
  tokenSymbol       String
  tokenSupply       String
  decimal           Int
  auditorsName      String
  adminCommission   Float
  assetValue        Float
  categoryId        String
  assetTypeId       String
  tokenTypeId       String
  offerStartDate    DateTime
  offerEndDate      DateTime
  rewardDate        DateTime?
  riskScale         RiskScale
  createdAt         DateTime  @default(now())
  updatedAt         DateTime  @updatedAt
  creatorId         String?
  assetImageKey     String?
  auditorsReportKey String?
  contractTemplate  String?
  description       String?
  documentKey       String?
  imageOneKey       String?
  imageTwoKey       String?
  network           String?
  productImageKey   String?
  reward            String?
  status            Status    @default(PENDING)
  assetType         AssetType @relation(fields: [assetTypeId], references: [id], onDelete: Cascade)
  category          Category  @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  tokenType         TokenType @relation(fields: [tokenTypeId], references: [id], onDelete: Cascade)
}

model RefreshToken {
  id        String   @id @default(uuid())
  token     String   @unique
  userId    String?
  adminId   String?
  expiresAt DateTime
  createdAt DateTime @default(now())
  admin     Admin?   @relation(fields: [adminId], references: [id])
  user      User?    @relation(fields: [userId], references: [id])
}

enum RoleType {
  investor
  campaigner
}

enum UserAccountType {
  INDIVIDUAL
  MULTIPLE
  CORPORATE
}

enum IncomeFrequencyType {
  DAILY
  WEEKLY
  MONTHLY
  YEARLY
}

enum BankAccountType {
  PERSONAL
  NON_PERSONAL
  OTHER
}

enum AdminRoleType {
  SUPER_ADMIN
  NOTIFICATION_COMMUNICATION
  KYC_COMPLIANCE
  PRODUCT_CROWDFUNDING
  TOKEN_MANAGEMENT
  FINANCE
}

enum CategoryType {
  PRODUCT
  TOKEN
}

enum RiskScale {
  LOW
  MEDIUM
  HIGH
}

enum Status {
  PENDING
  LIVE
  SOLD
  REJECTED
}

enum UserStatus {
  PENDING
  APPROVED
  REJECTED
}
