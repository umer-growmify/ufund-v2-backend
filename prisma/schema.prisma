generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                String         @id @default(uuid())
  email             String         @unique
  firstName         String
  lastName          String
  phoneNumber       String?
  countryCode       String?
  password          String?
  roles             RoleType[]
  agreedToTerms     Boolean
  isVerified        Boolean        @default(false)
  verificationToken String?
  provider          String?
  providerId        String?
  createdAt         DateTime       @default(now())
  updatedAt         DateTime       @updatedAt
  profile           Profile?
  Products          Products[]
  Asset             Asset[]
  refreshTokens     RefreshToken[]
}

model Profile {
  id                 String              @id @default(uuid())
  userId             String              @unique
  user               User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  imageKey           String?
  userAccountType    UserAccountType     @default(INDIVIDUAL)
  incomeFrequency    IncomeFrequencyType @default(MONTHLY)
  totalAnnualRevenue Float               @default(0.0)
  addressLine1       String
  addressLine2       String?
  zipCode            String
  city               String
  state              String
  country            String
  companyName        String
  companyEmail       String
  companyTelephone   String
  companyAddress     String
  bankName           String
  accountNumber      String
  accountName        String
  routingNumber      String
  ibanNumber         String
  swiftNumber        String
  bankAccountType    BankAccountType     @default(PERSONAL)
  bankAddress        String
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt
}

model Admin {
  id            String         @id @default(uuid())
  name          String
  email         String         @unique
  password      String
  role          AdminRoleType
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  refreshTokens RefreshToken[]
}

model Category {
  id           String       @id @default(uuid())
  name         String       @unique
  imageUrl     String?
  block        Boolean      @default(false)
  categoryType CategoryType
  product      Products[]
  assets       Asset[]
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}

model AssetType {
  id        String   @id @default(uuid())
  name      String   @unique
  assets    Asset[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model TokenType {
  id        String   @id @default(uuid())
  name      String   @unique
  assets    Asset[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Products {
  id               String @id @default(uuid())
  productName      String
  brand            String
  numberOfProducts String
  hsCode           String
  eanCode          String
  upcCode          String

  categoryId        String?
  category          Category? @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  totalValue        String
  investmentProfit  Float
  adminCommission   Float?
  unitPrice         String?
  productTotalValue Float?
  campaignerId      String?
  campaigner        User?     @relation(fields: [campaignerId], references: [id], onDelete: Cascade)
  creatorId         String?
  description       String
  riskScale         RiskScale

  offerStartDate      DateTime
  offerEndDate        DateTime
  investmentStartDate DateTime
  maturityCountDays   Int
  maturityDate        DateTime
  auditorsReportKey   String?

  documentKey   String?
  tokenImageKey String?
  assetImageKey String?
  imageOneKey   String?
  imageTwoKey   String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  status Status @default(PENDING)
}

model Asset {
  id              String    @id @default(uuid())
  assetName       String
  tokenName       String
  tokenValue      String
  tokenSymbol     String
  tokenSupply     String
  decimal         Int
  auditorsName    String
  adminCommission Float
  assetValue      Float
  categoryId      String
  category        Category  @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  assetTypeId     String
  assetType       AssetType @relation(fields: [assetTypeId], references: [id], onDelete: Cascade)
  tokenTypeId     String
  tokenType       TokenType @relation(fields: [tokenTypeId], references: [id], onDelete: Cascade)

  userId    String?
  user      User?   @relation(fields: [userId], references: [id], onDelete: Cascade)
  creatorId String?

  network          String?
  contractTemplate String?

  offerStartDate DateTime
  offerEndDate   DateTime
  rewardDate     DateTime?
  reward         String?
  description    String?
  riskScale      RiskScale

  documentKey       String?
  auditorsReportKey String?
  productImageKey   String?
  assetImageKey     String?
  imageOneKey       String?
  imageTwoKey       String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt
  status            Status   @default(PENDING)
}

model RefreshToken {
  id        String   @id @default(uuid())
  token     String   @unique
  userId    String?
  user      User?    @relation(fields: [userId], references: [id])
  adminId   String?
  admin     Admin?   @relation(fields: [adminId], references: [id])
  expiresAt DateTime
  createdAt DateTime @default(now())
}

enum RoleType {
  investor
  campaigner
}

enum UserAccountType {
  INDIVIDUAL
  MULTIPLE
  CORPORATE
}

enum IncomeFrequencyType {
  DAILY
  WEEKLY
  MONTHLY
  YEARLY
}

enum BankAccountType {
  PERSONAL
  NON_PERSONAL
  OTHER
}

enum AdminRoleType {
  SUPER_ADMIN
  NOTIFICATION_COMMUNICATION
  KYC_COMPLIANCE
  PRODUCT_CROWDFUNDING
  TOKEN_MANAGEMENT
  FINANCE
}

enum CategoryType {
  PRODUCT
  TOKEN
}

enum RiskScale {
  LOW
  MEDIUM
  HIGH
}

enum Status {
  PENDING
  LIVE
  SOLD
  REJECTED
}
